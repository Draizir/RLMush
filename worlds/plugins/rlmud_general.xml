<?xml version="1.0" encoding="iso8859-15"?>
<!DOCTYPE muclient [
  <!ENTITY prefijo "(?:(?:.*?)(?:\&gt; |\] |\} )|)" >
  <!ENTITY intens "(?:(con (poca fuerza|fuerza|mucha fuerza|fuerza sobrehumana|fuerza divina|increíble potencia|cólera titánica)|débilmente|violentamente) |)" >
  ]>
<!-- Saved on sábado, mayo 06, 2017, 6:03 p.m. -->
<!-- MuClient version 4.94 -->

<!-- Plugin "rlmud_general" generated by Plugin Wizard -->

<muclient>
<plugin
   name="rlmud_general"
   author="Francisco R. Del Roio"
   id="a2e935565e67898a471d5a1d"
   language="Lua"
   purpose="Plugin de Reinos de leyenda"
   date_written="2017-05-06 18:01:08"
   requires="4.84"
   version="1.0"
   
   >
<description trim="y">
<![CDATA[
Este es un plugin que contiene triggers y alias para Reinos de leyenda.
]]>
</description>

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Triggers  -->


<triggers>

  <!-- Generales -->
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;Tiras de las riendas de (.*?) haciendo que te siga\.$"
   omit_from_output="y"
   regexp="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="general"
   match="^&prefijo;(?P&lt;personaje&gt;.*?) llega desde (?:el |)(?P&lt;direccion&gt;\w+)(?P&lt;seguidores&gt; seguido de (.*?)|)\.$"
   script="on_llegar"
   lowercase_wildcard="y"
   regexp="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^\[(?P&lt;pjname&gt;\w*)(?: .*?|) orbita a Eirea\]$"
   regexp="y"
   send_to="12"
   sequence="99"
  >
  <send>play_sound("canales/login.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^\[(?P&lt;pjname&gt;\w*)(?: .*?|) orbita al Limbo\]$"
   regexp="y"
   script="on_logout"
   sequence="90"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^(?P&lt;pjs&gt;.*?) está(?:n|) aquí\.$"
   regexp="y"
   script="on_room_pjs"
   sequence="101"
  >
  </trigger>

  <trigger
   group="General"
   lines_to_match="2"
   match="^&prefijo;(?P&lt;room_name&gt;.*?)\n\s\[(?P&lt;exits&gt;[a-z\|\-\~\*\,]*)\] \((?P&lt;branches&gt;[a-z\|\-\~\*\,]*)\)\ $"
   multi_line="y"
   regexp="y"
   script="on_mirar"
   sequence="100"
   enabled="y"
   name="mirar_arbol"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;(?P&lt;room_name&gt;.*?) \[(?P&lt;exits&gt;[a-z\|\-\~\*\,]*)\]\ (?:\[.*\] |)$"
   name="mirar"
   regexp="y"
   script="on_mirar"
   sequence="100"
   lowercase_wildcard="y"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^(.*?) te sigue(?:n|)\.$"
   regexp="y"
   sequence="100"
   script="on_seguir"
  >
  </trigger>

  <trigger
   enabled="n"
   group="Nickeador"
   match="^(?:\-+\] |)Mortales(?: \[\-+|\s+)$"
   name="empezar_who"
   regexp="y"
   sequence="100"
   script="on_who"
  >
  </trigger>
  <trigger
   enabled="n"
   group="Nickeador"
   match="^(\=+\[ |)Hay (.*?) en Eirea( \]\=+|\s+)|\=+$"
   name="terminar_who"
   regexp="y"
   sequence="100"
   script="on_who"
  >
  </trigger>
  <trigger
   enabled="n"
   group="Nickeador"
   match="^\s+(?P&lt;pj&gt;\w+)(?: .*?|) (el|la) .*$"
   name="agregar_pj"
   regexp="y"
   sequence="100"
   lowercase_wildcard="y"
   script="on_who"
  >
  </trigger>

  <trigger
   enabled="n"
   group="Objetivos"
   lines_to_match="2"
   match="^&prefijo;Añadiendo nombre corto (?P&lt;nickname&gt;\w+) como\s(?P&lt;actual&gt;.*?)\.$"
   multi_line="y"
   name="nuevo_nick"
   regexp="y"
   sequence="100"
   script="on_nick"
  >
  </trigger>
  <trigger
   enabled="n"
   group="Objetivos"
   lines_to_match="2"
   match="^&prefijo;Nombre corto ((?:\w+(?:\,|))+) borrado de (?P&lt;nickname&gt;\w+) quedando\s(?P&lt;actual&gt;(?:\w+(?:\,|))+)\.$"
   multi_line="y"
   name="nick_eliminado"
   regexp="y"
   sequence="100"
   script="on_nick"
  >
  </trigger>
  <trigger
   enabled="n"
   group="Objetivos"
   lines_to_match="3"
   match="^&prefijo;Nombre corto (?&lt;nickname&gt;\w+) cambiado de\s(?:(?:\w+(?:\,|))+) a\s(?P&lt;actual&gt;(?:\w+(?:\,|))+)\.$"
   multi_line="y"
   name="nick_cambiado"
   regexp="y"
   sequence="100"
   script="on_nick"
  >
  </trigger>
  <trigger
   enabled="n"
   group="Objetivos"
   match="^Nombre corto (\w+) borrado\.$"
   regexp="y"
   sequence="100"
  >
  </trigger>

  <!-- Habilidades -->

  <!-- Carga -->
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="^&prefijo;Vociferas gritos de guerra\, demandando a (?P&lt;pjname&gt;.*?) un desafío y comienzas tu brutal carga\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/carga/iniciar.ogg", "-50")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="^&prefijo;\# ¡Maldición\!\, ¡(?P&lt;pjname&gt;.*?) consigue evitar vuestra carga\, dejándoos en muy mala posición\!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_random_sound("combate/esquivar", 1, 15, ".ogg", "30")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="¡* te bendice con una carga crítica!"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/carga/impacto.ogg", "30")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="^&prefijo;\# (Terminas tu carga|Con la decisión de los grandes caballeros|Avanzas zigzagueando hacia|Consumas tu devastador asalto contra|Enarbolas tu (.*?) para amedrentar a|Tus bramidos de guerra reverberan en el entorno|Lanzas rápidamente todo tu cuerpo como un poderoso latigazo|¡En el último instante\, (.*) logra eludirse de tu devastadora carga|Lanzas un amago de golpe con)"
   send_to="12"
   regexp="y"
   sequence="100"
  >
  <send>play_sound("habilidades/carga/impacto.ogg", "50")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   ignore_case="y"
   match="^&prefijo;(?P&lt;pjname&gt;.*?) vocifera gritos de guerra\, demandando un desafío contra ti (?:.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/carga/iniciar.ogg", "50")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="^&prefijo;\* (?P&lt;pjname&gt;.*?) choca contra ti\, culminando su carga con un golpe de su (.*?) (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/carga/impacto.ogg", "-50")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Cargar"
   match="^&prefijo;\* Logras evitar la carga de (?P&lt;pjname&gt;.*?)\, dejándole en muy mala posición\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_random_sound("combate/esquivar", 1, 15, ".ogg", "-50")</send>
  </trigger>


  <!-- Golpe arcano -->
  <trigger
   enabled="y"
   group="habilidades_golpearcano"
   match="^&prefijo;Pasas tu mano sobre tu (.*?) mientras te concentras intentando despertar su magia\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/hechiceros/golpe arcano/despertar.ogg", -30)</send>
  </trigger>

  <!-- Ataque doble -->
  <trigger
   enabled="y"
   group="habilidades_maestria"
   lines_to_match="2"
   match="^&prefijo;\+ Tensas tus músculos preparando un nuevo ataque\. ¡Golpeas a (.*?) y rápidamente\, secundas tu ataque con un certero movimiento\!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
   <send>
	play_sound("habilidades/maestria/ataquedoble/"..math.random(1,6)..".ogg", -30)
	playDelay("habilidades/maestria/ataquedoble/"..math.random(1,6)..".ogg", 0.13, 50)
   </send>
  </trigger>


  <!-- Apu;alar -->
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;\* ¡Convulsionas en agonía cuando (.*?) te apuñala por la espalda\!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/bribones/apuñalar/" .. math.random(1,7) .. ".ogg", -50)</send>
  </trigger>

  <!-- Golpe certero -->
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;¡Imbuído por el fragor de la batalla\, canalizas toda la ira que habita en tí en tu arma\, descargándola sobre tu enemigo con un (.*?) y (.*?) movimiento"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>
	if "%1" == "armonioso" and "%2" == "equilibrado" then
		play_sound("habilidades/luchadores/soldado/golpecertero/normal.ogg", 40)
	elseif "%1" == "fugaz" and "%2" == "preciso" then
		play_sound("habilidades/luchadores/soldado/golpecertero/rápido.ogg", 40)
	elseif "%1" == "sádico" and "%2" == "brutal" then
		play_sound("habilidades/luchadores/soldado/golpecertero/poderoso.ogg", 40)
	end
  </send>
  </trigger>

  <!-- Barrido -->
  <trigger
   enabled="y"
   group="habilidades"
   lines_to_match="2"
   keep_evaluating="y"
   match="^&prefijo;¡Con un amplio movimiento en forma de arco de tu poderoso brazo barres a todos los oponentes frente a ti\!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/barrido.ogg")</send>
  </trigger>

  <!-- Escupitajo ácido -->
  <trigger
   enabled="y"
   group="incursor"
   match="^&prefijo;Tras acumular un montón de saliva\, lanzas una esfera gelatinosa de ácido contra (.*?) volando en dirección (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/luchadores/incursor/escupitajo ácido/escupir" .. math.random(1,2) .. ".ogg", -40)</send>
  </trigger>


  <!-- Herir -->
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;¡(.*?) comienza a sangrar abundantemente por sus heridas múltiples en (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/maestria/herir/sangramiento.ogg", 35)</send>
  </trigger>

  <!-- Oficios -->

  <trigger
   enabled="y"
   group="oficios"
   match="^Veta de (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/encontrar veta.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Picar"
   match="^&prefijo;Veta de (.*?) parece haberse agotado\.$"
   regexp="y"
   send_to="12"
   sequence="99"
  >
  <send>play_sound("habilidades/picar/desprendimiento" .. math.random(1, 2) .. ".ogg")</send>
  </trigger>

  <!-- Canales -->
  <trigger
   enabled="y"
   group="Canales"
   match="^&prefijo;(?P&lt;pjname&gt;\w*) dice(?:.*?)\: (?P&lt;message&gt;.*?)$"
   name="decir"
   regexp="y"
   script="on_channel"
   sequence="95"
  >
  </trigger>
  <trigger
   enabled="y"
   group="Canales"
   match="^&prefijo;(?P&lt;pjname&gt;\w*?) grita(?:.*?)\: (.*?)$"
   name="gritar"
   regexp="y"
   script="on_channel"
   sequence="95"
  >
  </trigger>
  <trigger
   enabled="y"
   group="Canales"
   match="^&prefijo;(?P&lt;pjname&gt;\w*?) te (?:dice|pregunta|exclama)\: (?P&lt;message&gt;.*?)$"
   name="tell"
   regexp="y"
   script="on_channel"
   sequence="95"
   lowercase_wildcard="y"
  >
  </trigger>

  <!-- Hechizos -->

  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;(?P&lt;pjname&gt;.*?) empieza a formular un hechizo\.$"
   name="formulando"
   regexp="y"
   script="on_formular"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   match="^&prefijo;¡Te estremeces y pierdes la concentración\!$"
   regexp="y"
   sequence="100"
  >
  </trigger>

  <!-- Llamar rayos -->
  <trigger
   enabled="y"
   group="Hechizos"
   match="Nubes negras de tormenta se ciernen sobre el área."
   name="lliniciar"
   script="on_hechizo"
   sequence="100"
  >
  </trigger>

  <!-- Combate -->

  <trigger
   enabled="y"
   group="Combate"
   match="^&prefijo;Estás siendo atacad[a,o] por (.*?)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("luaaudio/error.ogg")</send>
  </trigger>

  <!-- Enemigo -->
  <trigger
   enabled="y"
   group="Combate"
   match="^&prefijo;\* Logras parar el ataque de (?:.*?)\."
   regexp="y"
   send_to="12"
   sequence="100"
   name="parar_enemigo"
  >
  <send>play_random_sound("combate/parada", 1, 8, ".ogg", "-50")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Combate"
   match="^&prefijo;\* (?:.*?) intenta (?:.*?)\, pero logras parar su ataque\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_random_sound("combate/parada", 1, 8, ".ogg", "-30")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Combate"
   match="^&prefijo;\* Paras críticamente el ataque desarmado de (?P&lt;pjname&gt;.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
   name="parar_enemigo_critico"
  >
  <send>play_random_sound("combate/parada", 1, 8, ".ogg", "-30")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Combate"
   match="^&prefijo;\* (?:.*?) intenta (?:.*?)\, pero logras parar críticamente su ataque\.$"
   regexp="y"
   send_to="12"
   sequence="100"
   name="parar_enemigo_critico_2"
  >
  <send>play_random_sound("combate/parada", 1, 8, ".ogg", "-30")</send>
  </trigger>

  <!-- Eventos -->
  <trigger
   enabled="y"
   group="Eventos"
   match="^&prefijo;Lish la Aborrecible\, el Venerable Dragón Rojo os presenta el mismísimo Infierno"
   name="lish_fuego"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("eventos/fuego.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Eventos"
   match="^&prefijo;El gutural sonido de una poderosa inspiración hace retumbar las paredes de la cueva\. Algo no va bien\.\.\.$"
   name="lish_aliento_exterior"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/alerta.ogg")</send>
  </trigger>

  <!-- Ataque a ciudadanías -->
  <trigger
   enabled="y"
   group="Ataque"
   match="^&prefijo;¡La campana de la Torre de la Santa Cruzada resuena por todo el reino\, anunciando un ataque al Bastión del Bien\!$"
   regexp="y"
   send_to="12"
   sequence="200"
  >
  <send>play_sound("notificaciones/ataque a takome.ogg")</send>
  </trigger>

  <trigger
   enabled="y"
   group="Hechizos"
   match="Un rayo impacta sobre *."
   name="llimpacto"
   script="on_hechizo"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^(?:\s*?)Los Dioses te dan la bienvenida a sus Reinos de Leyenda\, (?P&lt;pjname&gt;\w*)\.(?:\s*?)$"
   name="login"
   regexp="y"
   script="on_login"
   sequence="100"
   lowercase_wildcard="y"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;(.*?) se va hacia (?P&lt;dir&gt;\w+)\.$"
   regexp="y"
   script="on_irse"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;Desmontas de tu (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>EnableAlias("galopar", 0)</send>
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;Montas en (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>EnableAlias("galopar", 1)</send>
  </trigger>
  <trigger
   enabled="y"
   group="General"
   match="^&prefijo;Parece que (.*?) no produjo efecto alguno\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("info/comando incorrecto.ogg")</send>
  </trigger>
</triggers>

<aliases>
  <alias
   match="wh"
   enabled="y"
   script="do_who"
   name="hostil"
   sequence="100"
  >
  </alias>
  <alias
   match="wm"
   enabled="y"
   script="do_who"
   name="matar"
   sequence="100"
  >
  </alias>
  <alias
   match="wa"
   enabled="y"
   script="do_who"
   name="pk"
   sequence="100"
  >
  </alias>
</aliases>

<triggers>
  <trigger
   enabled="y"
   group="combate"
   match="&prefijo;(.*?) te (corta|raja|sesga) &intens;en (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/" .. math.random(1,9) .. ".ogg", -50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="Subes a nivel * por * monedas de *."
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/nivel/"..math.random(1,6)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   match="Tu * se rompe en mil pedazos inservibles."
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="area"
   match="^&prefijo;Escuchas un grito ahogado\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
wait.time(0.5)
play_sound("area/nagrung/templo ancestral/espectro/chillido.ogg")
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="area"
   match="^Tras escuchar una terrorífica carcajada tras de ti, tu cuerpo es tele transportado a otro lugar.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("area/nagrung/bosque negro/carcajada.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Tu ^(.*?) brilla con un ligero aura al ser encantad[oa]\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>file = GetInfo(67).."/sonidos/magia/encantar vara.ogg"
Sound(file)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\* (.*?) te (perfora|pincha) &intens;en (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/"..math.random(1,15)..".ogg", -30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\* Logras esquivar críticamente el ataque de (?:.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/esquivar/" .. math.random(1,15) .. ".ogg", -30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\* Logras esquivar críticamente (?:.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/esquivar/" .. math.random(1,15) .. ".ogg", -30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\* (.*?) intenta (.*?)\, pero logras esquivar su ataque\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/esquivar/" .. math.random(1,15) .. ".ogg", -40)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\* Logras esquivar el ataque de (?:.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/esquivar/" .. math.random(1,15) .. ".ogg", -40)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="Un rayo de energía positiva surge de la palma de tu mano y golpea a*"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/rayo de energia positiva.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="Una serie de cortes * aparecen en la piel de *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/causar heridas.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;\[Obtienes el logro '(.*?)' (.*?)\]$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/logro.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="music"
   match="^        Los Dioses te dan la bienvenida a sus Reinos de Leyenda, (.*?)       $"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("musica/intro.mp3")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;(.*?) misil[es] mágico[s] surge[n] de tus dedos e impacta[n] infaliblemente sobre(.*?)$"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("magia/proyectil magico.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="Â¡* invoca una columna de fuego sobre ti!"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=-50")
play_sound("magia/columna de fuego.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="Â¡Envuelves a * en tu Estallido de fuego!"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("magia/estallido de fuego.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="Â¡Invocas una columna de fuego sobre *"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
file = GetInfo(67).."/sonidos/magia/columna de fuego.ogg"
Sound(file)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^(.*?)Un llameante rayo de fuego rojo se forma en tus manos\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>file = GetInfo(67).."/sonidos/magia/hoja de llamas.ogg"
Sound(file)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^(.*?)Una llama de fuego brota en tu mano\.$"
   regexp="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;Â¡Has completado la misión '(.*?)'!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/misión/terminar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="notificaciones"
   match="^(.*?)Â¡Has iniciado la misión '(.*?)'!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/misión/iniciar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   lines_to_match="3"
   keep_evaluating="y"
   match="^(.*?)Alzas tus manos al cielo y nubes negras de tormenta se forman acudiendo a tu llamada y descargando en el área una potente pedregada\.$"
   multi_line="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/granizar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="efectos"
   match="^¡Tu golpe causa una profunda herida a (?:.*?) en (.*?)!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("equipo/efectos/sangrado.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="efectos"
   match="^¡Tu golpe causa una profunda herida a (?:.*?)!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("equipo/efectos/sangrado.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;(.*?) rayo[s] cae[n] desde el cielo envolviéndolo todo en un caos."
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=40")
file = GetInfo(67).."/sonidos/magia/divina/natural/llamar rayos/inicio.ogg"
Sound(file)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_incursor"
   match="^(.*?)Con un burbujeante ulular, comienzas a acumular saliva ácida para disparar un gran chorro contra tu presa.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=-50")
play_sound("habilidades/luchadores/incursor/escupitajo ácido/empezar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Aplastas|Golpeas) &intens;en (.*?) a (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/aplastantes/"..math.random(1,9)..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Curas algunas de las heridas más (ligeras|moderadas|serias|críticas) de (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/curadora/curar heridas/%1 otro.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Perforas|Pinchas) &intens;en (.*?) a (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/"..math.random(1,15)..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Perforas|Pinchas) críticamente a (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/critico.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Perforas|Pinchas) &intens;a (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/"..math.random(1,15)..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Curas algunas de tus heridas más (ligeras|moderadas|serias|críticas)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/curadora/curar heridas/%1.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^(.*?)El cuerpo de (.*?) sufre terribles sacudidas debido a una potente descarga eléctrica\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("magia/presa sacudidora.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="Â¡Los soportes de la mina crujen y se produce un desprendimiento!"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/desprendimiento/"..math.random(1,2)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="Â¡Se ha producido una explosión de gas!"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/explosion de gas.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   match="Â¡Se ha producido una fuga de gas tóxico!"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   match="Â¡Se inicia la jornada de XP Doble!!!"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="Â¡Tu fe en * ha aumentado!"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/ganar fe.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Alzas el puño hacia el cielo, y este retumba y relampaguea como respuesta.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=30")
file = GetInfo(67).."/sonidos/magia/divina/natural/llamar rayos/empezar.ogg"
Sound(file)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;Coges (.*?) de (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("acciones/coger.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="especiales"
   match="^&prefijo;El Filo del Ocaso vuelve a tener su aspecto normal cuando dejas de sostenerlo\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("equipo/especiales/filo del ocaso/desempunyar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_incursor"
   match="^&prefijo;Impactas de lleno a (.*?) con tu chorro de saliva, recubriendol[ea] (.*?) con tu ácido y haciendo que grite de agonía cuando su carne se convierte en una masa burbujeante derretida.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/luchadores/incursor/escupitajo ácido/impacto.ogg", 55)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;El Sol sale por el horizonte indicándote el comienzo de un nuevo día.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/día.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   lines_to_match="2"
   keep_evaluating="y"
   match="^(.*?)La madera del suelo empieza a ensortijarse a medida que tu salmodia acrecenta su volumen.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/natural/palos a serpientes/madera.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   lines_to_match="2"
   keep_evaluating="y"
   match="^(.*?)Realizas una serie de gestos y ademanes mientras farfullas una sarta de conjuros\.$"
   multi_line="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/natural/palos a serpientes/sarta.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^(.*?)Rezas una plegaria a (.*?) y tocas a (.*?) transmitiéndol[ea] su (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/%4.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate_elemental"
   match="^(.*?)Sometes a (.*?) a una poderosa ráfaga mágica.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/elemental/magico/critico.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;Examinas la defensa de (.*?) en busca de un hueco por donde hacer mucho daño\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/luchadores/soldado/golpecertero/inicio.ogg", 40)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;La noche cubre Eirea con su oscuro manto.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/noche.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="# Unes tus pulgares y extiendes tus dedos, de los cuales brota un chorro de*"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/manos ardientes.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Nubes negras de tormenta se ciernen sobre el área.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=0")
play_sound("magia/divina/natural/llamar rayos/nubes.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="omitir"
   match="&gt; "
   omit_from_log="y"
   omit_from_output="n"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Paralizas a (.*?) mediante una fuerza divina que le rodea.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("magia/divina/natural/retener animal.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="area"
   lines_to_match="2"
   keep_evaluating="y"
   match="(.*?)De la salida (.*?) surgen decenas de dardos que se te clavan por todo el(.*?)\Z"
   multi_line="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("area/isla kalea/dardos.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="muerte"
   match="^&prefijo;Propinas el golpe mortal a (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("volume=100")
play_sound("combate/propinar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   match="* empieza a formular un hechizo."
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/alguien formula un hechizo.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="*# Clavas * en *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/apuñalar/"..math.random(1,7)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="notificaciones"
   match="^&prefijo;Tu estatus con (.*?) ha aumentado.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/ganar estatus.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="especiales"
   match="^&prefijo;Un fulgor azulado empieza a recubrir el Filo del Ocaso cuando lo empuñas\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/especiales/filo del ocaso/empunyar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="*Con fuerza clavas *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/apuñalar/"..math.random(1,7)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;Un nuevo hito se ha escrito en tu diario de la misión '(.*?)'.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/misión/hito.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="incursor"
   match="*Con un burbujeante ulular, comienzas a acumular saliva ácida para disparar un gran chorro contra tu presa."
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=-50")
play_sound("habilidades/luchadores/incursor/escupitajo ácido/empezar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   lines_to_match="3"
   keep_evaluating="y"
   match="^&prefijo;Un penetrante siseo inunda la sala cuando tu hechizo termina y aparecen (.*?) serpientes culebreando entre tus piernas.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/natural/palos a serpientes/éxito.ogg")
require "wait"
wait.make(function()
wait.time(0.3)
play_sound("magia/divina/natural/palos a serpientes/serpientes/" .. math.random(1,3) .. ".ogg")
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="incursor"
   match="*Tras acumular un montón de saliva, lanzas una esfera gelatinosa de ácido contra * volando en dirección *."
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=-40")
play_sound("habilidades/luchadores/incursor/escupitajo ácido/escupir" .. math.random(1,2) .. ".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;Un rayo impacta (junto a |sobre |)(.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("magia/divina/natural/llamar rayos/impacto.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="*Tus garras argénteas se tiñen de carmesí al desgarrar a *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/zarpazo/acerto.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="*Vislumbras una oportunidad de ataque contra *"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=-50")
play_sound("habilidades/bribones/oportunidad/aviso.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;[Info-Omiq]: Se inicia una omiq de tipo (.*?)$"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/omiq.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   lines_to_match="3"
   keep_evaluating="y"
   match="^&prefijo;\# (.*?) vocifera gritos de guerra, demandando un desafío contra ti mientras comienza su brutal carga\.$"
   multi_line="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("habilidades/carga/iniciar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="muerte"
   match="*cae al suelo sin vida."
   send_to="12"
   sequence="100"
  >
  <send>random = math.random(1,81)
require "wait"
wait.make(function()
wait.time(0.3)
play_sound("combate/muertes/caer/" .. random .. ".ogg")
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Cortas|Rajas|Sesgas) &intens;en (.*?) a (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/"..math.random(1,9)..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Cortas|Rajas|Sesgas) &intens;a (?:.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/"..math.random(1,9)..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Cortas|Rajas|Sesgas) críticamente a (?:.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/critico.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;¡Lanzas un ataque de oportunidad contra (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("habilidades/bribones/oportunidad/acerto.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Desgarras|Horadas|Hieres|Atraviesas) a (.*?) en (.*?) con tu Lanza de Diamante dejando\s(.*?)(\.|)$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>if "%4" == "el aire cargado de chispas mágicas" then
play_sound("combate/armas/penetrantes/lanza de diamante/chispas magicas.ogg", 50)
elseif "%4" == "un cegador rastro de luz solar en el aire" then
play_sound("combate/armas/penetrantes/lanza de diamante/luz solar.ogg", 50)
else
play_sound("combate/armas/penetrantes/lanza de diamante/chispas magicas.ogg", 50)
end</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="*Â¡Oh, vaya, * parece haberse dado cuenta de tus intenciones!"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/apuñalar/fallo.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate_elemental"
   match="^&prefijo;\# (Quemas|Abrasas) (con |)(débilmente |poca intensidad |intensamente |)en (.*?) a (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/elemental/fuego/" .. math.random(1,5) .. ".ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="especiales"
   match="*Â¡Tu * absorve parte de la vida de *"
   send_to="12"
   sequence="100"
  >
  <send>Sound("pan=50")
play_sound("combate/especiales/equipamiento vampirico.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="omitir"
   match="0m"
   omit_from_log="y"
   omit_from_output="n"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Arremetes contra (.*?) asestándole un temible golpe en (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/aplastantes/critico.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_maestria"
   match="(?:prefijo)Con un ataque artístico ensartas (.*?) de (.*?) con tu (.*?), manchando el suelo de sangre cuando l[oa] retiras con un grácil movimiento.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/maestria/estocada/estoque o florete.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate_elemental"
   match="^&prefijo;\# Congelas (con |)(débilmente |poca intensidad |intensamente |)en (.*?) a (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/elemental/frio/" .. math.random(1,3) .. ".ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;\# Culminas tu ataque con una sublime estocada de tu (.*?) contra (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/maestria/estocada/comun.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="Comienzas a nadar en dirección *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("acciones/nadar/"..math.random(1,6)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Empalas críticamente a (.*?) en (.*?)\, haciendo que puedas ver\sel\sradiante\sbrillo\sde\stu\slanza\sal\smirar\sen\ssu\sinterior\scuando\sgrita\sagónicamente\.$"
   regexp="y"
   multi_line="y"
   lines_to_match="2"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/lanza de diamante/critico.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="Con un pequeño grito descargas tu fuerza contra *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/"..math.random(1,6)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="Habilidades-Picar"
   match="^&prefijo;Consigues extraer (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/extraer mineral.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;\# Hundes tu (.*?) en (.*?) de (.*?) ignorando sus defensas\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/maestria/herir/impacto" .. math.random(1,3) .. ".ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Intentas (.*?) en (.*?) a (.*?), pero ést[ea] consigue esquivar |críticamente tu ataque.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/esquivar/" .. math.random(1,15) .. ".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# (Perforas|Atraviesas) &intens;en (.*?) a (.*?) con un(a|) (.*?) certer[oa]\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="97"
  >
  <send>require "wait"
wait.make(function()
play_sound("combate/armas/proyectiles/disparo/" .. math.random(1,2) .. ".ogg", -30)
if "%7" == "flecha" then
play_sound("combate/armas/proyectiles/impacto/flecha" .. math.random(1,2) .. ".ogg", 40)
elseif "%7" == "saeta" or "%7" == "dardo" then
wait.time(0.1)
play_sound("combate/armas/proyectiles/impacto/saeta" .. math.random(1,3) .. ".ogg", 40)
end
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="Debido a tu experiencia avanzas a nivel * de*"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Intentas (.*?) en (.*?) a (.*?), pero ést[ea] consigue parar |críticamente tu ataque.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/parar/" .. math.random(1,29) .. ".ogg", 40)</send>
  </trigger>
  <trigger
   enabled="y"
   match="&gt; "
   omit_from_output="n"
   sequence="99"
  >
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="Empuñas tu *"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("equipo/empunyar/"..math.random(1,3)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;\# Pronuncias unas palabras mágicas y tu (.*?) se ilumina con un resplandor blanquecino que quema mágicamente los tejidos corporales de (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/hechiceros/golpe arcano/daño.ogg", 40)</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Laceras &intens;(.*?) de (.*?) con un rápido coletazo\.$"
   regexp="y"
   send_to="12"
   sequence="99"
  >
  <send>play_sound("combate/armas/desarmado/coletazo/" .. math.random(1,2) .. ".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="Entierras *"
   omit_from_output="n"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("otros/cavar/"..math.random(1,14)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="combate"
   match="^&prefijo;\# Realizas un salto hacia (?:.*?) descargando un tremendo corte crítico con brutalidad en (?:.*?)\.$"
   omit_from_log="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/critico.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="^&prefijo;Golpeas (.*?) en afán de conseguir algo valioso\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/"..math.random(1,6)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades"
   match="^&prefijo;Enarbolas tu|tus (.*?) y examinas a (.*?) buscando puntos débiles expuestos por donde poder descuartizarlo\.$"
   regexp="y"
   send_to="12"
   sequence="99"
  >
  <send>Sound("pan=-50")
play_sound("habilidades/maestria/herir/inicio.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="^&prefijo;(Gotas de sudor corren por tu cara mientras sigues picando enérgicamente\.|Golpeas la (veta|pared) en afán de conseguir algo valioso\.|Picas fervientemente sobre la irregular superficie de la (veta|roca)\.|Con un pequeño grito descargas tu fuerza contra la (veta|roca)\.)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/"..math.random(1,6)..".ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="armas"
   match="^&prefijo;\# Te lanzas sobre (.*?) clavándol[ea] tu (.*?) en (.*?)\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/penetrantes/critico.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="hechizos"
   match="^&prefijo;\# Â¡El cielo ruge cuando invocas un relámpago que cae sobre (.*?)!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("magia/divina/natural/relámpago/impacto.ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_cazador"
   match="^&prefijo;\# Â¡Cazas salvajemente a (.*?), enterrando tu (.*?) en su cuerpo!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/cazadores/cazar/acerto" .. math.random(1,2) .. ".ogg", 15)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_cazador"
   match="^&prefijo;Observas los movimientos de (.*?) para cazar de forma efectiva.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/cazadores/cazar/inicio.ogg", -15)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Golpeas en (.*?) a (.*?) con un( terrible| fuerza| débil|) ataque descendente de tu puño cerrado\.$"
   regexp="y"
   send_to="12"
   sequence="99"
  >
  <send>play_sound("habilidades/sacerdotes/vallar/khaldar/maza/".. math.random(1,2) ..".ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="&prefijo;\# Giras sobre tu vertical, propinando (.*?) codazos a (.*?) al haber dado media vuelta y agarrándole para desequilibrarle al dar la otra media. (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/sacerdotes/vallar/khaldar/desequilibrar/critico.ogg", 20)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="Transformando mentalmente tu puño cerrado en una enorme maza, descargas un devastador golpe descendente sobre (.*?) de (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/sacerdotes/vallar/khaldar/maza/critico.ogg", 30)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Sabiéndole herid[oa] golpeas a (.*?) con todas tus fuerzas, sintiendo como tu codo se adentra en su (.*?) hasta producir daños mortales.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/codazo/giro" .. math.random(1,3) .. ".ogg")
wait.time(0.1)
play_sound("habilidades/sacerdotes/vallar/khaldar/codazo/acerto mortal.ogg", 20)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Sorprendes a (.*?) propinándole en (.*?) una magnifica patada que ni tan siquiera la más dura armadura enana sería capaz de detener.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/voladora/salto critico.ogg", -10)
wait.time(0.05)
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/voladora/acerto critico.ogg", 30)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Abres un hueco en la defensa de (.*?) que te permite golpearle en (.*?) una y otra vez con tu puño(| desnudo)."
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/puño/mov" .. math.random(1,3) .. ".ogg", -10)
wait.time(0.03)
play_sound("habilidades/sacerdotes/vallar/khaldar/puño/critico" .. math.random(1,5) .. ".ogg", 40)
wait.time(0.03)
play_sound("habilidades/sacerdotes/vallar/khaldar/puño/critico" .. math.random(1,5) .. ".ogg", 40)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Culminas una( magistral| mediocre| buena|) patada voladora golpeando con tu pie( desnudo|) (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/voladora/salto.ogg", -10)
wait.time(0.05)
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/voladora/acerto.ogg", 40)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Golpeas &intens;(.*?) de (.*?) con tu pierna extendida.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>
require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/normal/mov.ogg", -10)
wait.time(0.05)
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/normal/".. math.random(1,2) ..".ogg", 50)
end)
</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Lanzas tres rápidas patadas a (.*?), que le alcanzan (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/triple/".. math.random(1,4) ..".ogg", 30)
wait.time(0.09)
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/triple/".. math.random(1,4) ..".ogg", 30)
wait.time(0.09)
play_sound("habilidades/sacerdotes/vallar/khaldar/patada/triple/".. math.random(1,4) ..".ogg", 30)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="habilidades_khaldar"
   match="^&prefijo;\# Tu puño(| desnudo) golpea &intens;(.*?) de (.*?).$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "wait"
wait.make(function()
play_sound("habilidades/sacerdotes/vallar/khaldar/puño/mov".. math.random(1,3) ..".ogg" -10)
wait.time(0.01)
play_sound("habilidades/sacerdotes/vallar/khaldar/puño/".. math.random(1,5) ..".ogg", 20)
end)</send>
  </trigger>
  <trigger
   enabled="y"
   group="area"
   match="^&prefijo;Con un estridente chillido el espectro abandona su carcasa material y huye dejando un brillante circulo en el suelo\.$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("area/nagrung/templo ancestral/espectro/huida.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   keep_evaluating="y"
   match="^&prefijo;Después de esforzarte durante rato picando te detienes confuso y resignado"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/extraer nada.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="especiales"
   match="^&prefijo;\# Â¡Alzas tu Martillo del Trueno y la tormenta retumba como respuesta (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/especiales/martillo del trueno/recargar.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="efectos"
   match="^&prefijo;\# Â¡Tu ataque descarga una ráfaga de frio contra (.*?)\!$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/efectos/matalagartos/".. math.random(1,3) ..".ogg", 50)</send>
  </trigger>
  <trigger
   enabled="y"
   group="otros"
   match="^&prefijo;Maestría de (.*?)\: (.*?) \(Impactos\: (.*?)\)"
   regexp="y"
   omit_from_output="n"
   send_to="2"
   sequence="100"
  >
  <send>%1, %2: %3</send>
  </trigger>
  <trigger
   enabled="y"
   group="armas"
   match="^&prefijo;\* (.*?) salta sobre ti descargando un brutal golpe en (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/cortantes/critico.ogg", -50)</send>
  </trigger>
  <trigger
   enabled="y"
   match="^&prefijo;Mejoras tu maestría en (.*?) gracias a (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("notificaciones/maestria.ogg")</send>
  </trigger>
  <trigger
   enabled="y"
   group="armas"
   match="^&prefijo;\* (.*?) te (?:aplasta|golpea) &intens;en (.*?)\.$"
   omit_from_output="n"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("combate/armas/aplastantes/"..math.random(1,9)..".ogg", -40)</send>
  </trigger>
  <trigger
   enabled="y"
   group="oficios"
   match="^&prefijo;Picas fervientemente sobre la irregular superficie de (.*?)"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_sound("habilidades/picar/"..math.random(1,6)..".ogg")</send>
  </trigger>

</triggers>

<!--  Aliases  -->

<aliases>
</aliases>

<aliases>
  <alias
   script="on_tarjet"
   match="^mt (?P&lt;tarjet&gt;(?:\w+(?:\,|))+)$"
   enabled="y"
   group="General"
   regexp="y"
   sequence="100"
   name="asignar"
  >
  </alias>
  <alias
   script="on_tarjet"
   match="^mta (?P&lt;tarjet&gt;\w+)$"
   enabled="y"
   group="General"
   regexp="y"
   sequence="100"
   name="agregar"
  >
  </alias>
  <alias
   script="on_tarjet"
   match="^mtr (?P&lt;tarjet&gt;\w+)$"
   enabled="y"
   group="General"
   regexp="y"
   sequence="100"
   name="quitar"
  >
  </alias>
  <alias
   name="galopar"
   match="esp *"
   group="General"
   sequence="100"
  >
  <send>galopar %1</send>
  </alias>
</aliases>

<!--  Script  -->













<script>
<![CDATA[
require("var")
require("math")
require("string")
require("rl_stuff")

function OnPluginListChanged()
	RLStuffListChanged()
end -- ListChanged

local pjs = {
	enemigos = {},
	matar = {},
	omiq = {},
}

armas = {
	aplastante = {
		type = "aplastantes",
		min = 1,
		max = 8,
		ext = ".ogg",
	},
	cortante = {
		type = "cortantes",
		min = 1,
		max = 8,
		ext = ".ogg",
	},
	penetrante = {
		type = "penetrantes",
		min = 1,
		max = 8,
		ext = ".ogg",
	},
	diamante = {
		type = "penetrantes",
		min = 1,
		max = 8,
		ext = ".ogg",
	},
}

function on_look(name, line, wildcards,style)
	-- TODO: Funcionalidad general
end -- on_look

function play_random_sound(folder, startrange, endrange, ext, pan)
	local number = math.random(startrange, endrange)

	play_sound(folder.."/"..number..ext, pan)
end -- play_random_sound

function on_attack(weapon, enemy, critic)
	local pan = ""
	local number = 0
	local soundfile = ""

	if enemy == 1 then
		pan = "40"
	else
		pan = "-40"
	end -- if

	if type(weapon) == "table" then
		if critic == 0 then
			number = math.random(weapon.min, weapon.max)
			soundfile = "combate/armas/"..weapon.type.."/"..number..weapon.ext
		else
			soundfile = "combate/armas/"..weapon.type.."/critico"..weapon.ext
		end -- if

		play_sound(soundfile, pan)
	else
		soundfile = "combate/armas/"..weapon
		play_sound(soundfile, pan)
	end -- if

end -- on_attack

function on_impactar(name, line, wildcards)
	local t = utils.split(name, "_")

	local arma = armas[t[1]]
	local enemigo = 0
	local critico = 1

	if t[2] == "enemigo" then
		enemigo = 1
	end -- if

	if t[3] ~= "critico" then
		critico = 0
	end -- if

	on_attack(arma, enemigo, critico)

		-- TODO: Do more processing of wildcards
end -- on_impactar

function on_formular(name, line, wildcards)
		play_sound("hechizos/alguien formula un hechizo.ogg")
end -- on_formular

function on_hechizo(name, line, wildcards)
		play_sound("hechizos/" .. name .. ".ogg")
end -- on_hechizo

function on_turno(name, line, wildcards)
	if name == "player" then
		play_sound("turnplayer.ogg")
	else
		play_sound("turnother.ogg")
	end
end -- on_turno

function on_muerte(name, line, wildcards)
	play_random_sound("muertes/caer", 1, 81, ".ogg")
end -- on_muerte

function on_login(name, line, wildcards)
	var.logged = wildcards.pjname
end -- on_login

function on_logout(name, line, wildcards)
	play_sound("canales/logout.ogg")
	if wildcards.pjname ~= var.logged then
		return
	end
	var.logged = nil
end -- on_logout

function list_to_string(list)
	local sresult = ""
	for k, e in pairs(list) do
		sresult = sresult..e..","
	end
	
	sresult = string.sub(sresult, 1, #sresult - 1)

	return sresult
end -- function

local function en_lista(lista, texto)
	-- Chequea una lista de personajes contra el texto de lista de players enviado por el mud.
	
	if not lista or lista == "" then return false end
	if not texto or texto == "" then return false end
	
	for _, pj in ipairs(utils.split(lista, ",")) do
		if texto:find(pj) then
			-- Si se encuentra el nombre del jugador en el nombre de una montura, sencillamente se sale devolviendo un "false"
			if texto:find("%a+ de "..pj) then
				return false
			elseif texto:find(string.format("%%a+ %%[%s%%]", pj)) then
				-- El jugador va montado así que es positivo.
				return true
			end -- patterns
			
			-- Si la búsqueda tiene éxito entonces retornamos un éxito
			return true 
		end -- texto
	end -- for
end -- function

function on_mirar()
	var.personajes = 0
end -- function

function on_room_pjs(n,ln,wc)
	local depurada = wc.pjs:gsub("[|-\\/*]", ""):lower()
	
	if en_lista(var.objetivos, depurada) then
		play_sound("Generales/hostil.wav")
	end -- if

	if en_lista(var.aliados, depurada) then
		play_sound("Generales/aliado.wav")
	end -- if
end -- function

function on_tarjet(name,line,wc)
	if name == "agregar" then
		print(string.format("Agregando %s a la lista de objetivos extras", wc.tarjet))
		
		if not var.extras then
			var.extras = wc.tarjet:lower()
		else
			var.extras = var.extras .. "," .. wc.tarjet:lower()
		end -- if
	else
		print(string.format("Asignando los extras %s.", wc.tarjet))
		var.extras = wc.tarjet
	end -- agregar
end -- function

function on_channel(name, line, wildcards)
	if wildcards.channame == nil then
		wildcards.channame = name
		wildcards.message = wildcards[0]
	end -- if
	play_sound("canales/"..wildcards.channame..".ogg")
	history_add(wildcards.channame, wildcards.message)
end -- on_channel

function do_who(nombre)
	if var.lista then
		print("Ya se están buscando nicks.")
		return
	end -- if
	
	var.lista = nombre
	EnableTrigger("empezar_who", true)
	Send("who "..nombre)
end -- do_who

function OnPluginSent(texto)
	if texto == "who" then
		var.lista = "todos"
		EnableTrigger("empezar_who", true)
	end -- if
	
	return true
end -- function

function on_irse(name, line, wildcards)
	local personaje, direccion = wildcards[1]:lower():gsub("[|-\\/*]", ""), wildcards[2]
	
	if en_lista(var.objetivos, personaje)  then
		play_sound(string.format("Movimiento/Enemigos/se va %s.mp3", direccion))
	else
		play_sound(string.format("Movimiento/Aliados/se va %s.mp3", direccion))
	end -- if
end -- function

function on_llegar(name, line, wildcards)
	local personaje, direccion = wildcards[1]:lower():gsub("[|-\\/*]", ""), wildcards[2]
	
	if en_lista(var.objetivos, personaje)  then
		play_sound(string.format("Movimiento/Enemigos/Llega %s.mp3", direccion))
	else
		play_sound(string.format("Movimiento/Aliados/Llega %s.mp3", direccion))
	end -- if
end -- function

function on_who(nombre,l,wc)
	if nombre == "empezar_who" then
		EnableTrigger("agregar_pj", true)
		EnableTrigger("terminar_who", true)
		return
	end -- empezar who
	
	if nombre == "agregar_pj" then
		var[var.lista] = var[var.lista] or ""
		
		if var[var.lista] ~= "" then
			var[var.lista] = var[var.lista]..","
		end -- agregar pj
		
		var[var.lista] = var[var.lista]..wc.pj:lower()
		return
	end -- agregar_pj
	
	if nombre == "terminar_who" then
		if var.lista == "matar" or var.lista == "hostil" then
			var.objetivos = var[var.lista]
			
			if var.extras then
				var.objetivos = var.objetivos..","..var.extras
			end -- if
		elseif var.lista == "pk" then
			var.aliados = var[var.lista]
		end -- if

		var[var.lista] = nil
		var.lista = nil
		EnableTrigger("agregar_pj", false)
		EnableTrigger("terminar_who", false)
		EnableTrigger("empezar_who", false)
		return
	end -- if
end -- function

function on_nick(nombre,linea,wc)
	local nickname, actual = wc.nickname, wc.actual
	local pjlist = rex.new("^(\\w+(\\,|))+$")
	
	if pjlist:match(actual) then
		if nickname == "x" then
			var.objetivos = actual
		elseif nickname == "y" then
			var.aliados = actual
		end -- if
	end -- if
end -- function

function on_seguir(n,l,wc)
	local pjs = wc[1]:lower()
	
	if en_lista(var.objetivos, pjs) then
		play_sound("notificaciones/Enemigo.ogg")
	end -- if
end -- function

]]>
</script>


<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="rl ayuda"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
end
]]>
</script> 

</muclient>
